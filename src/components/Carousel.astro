---
import CardTechnologies from "./CardTechnologies.astro";
---

<body>
  <div class="sliderAx h-auto">
    <div id="slider-0" class="container mx-auto">
      <CardTechnologies />
      <br />
    </div>

    <div id="slider-1" class="container mx-auto">
      <CardTechnologies />
      <br />
    </div>
  </div>
  <div class="flex justify-between w-12 mx-auto pb-2">
    <button id="sButton1" class="bg-purple-400 rounded-full w-4 pb-2"></button>
    <button id="sButton2" class="bg-purple-400 rounded-full w-4 p-2"></button>
  </div>

  <script>
    var cont = 0;
    var totalSliders = 2; // Cambia este valor según la cantidad de sliders que tengas
    var intervalTime = 12000; // Tiempo entre cambios automáticos
    var carouselTec;

    function loopSlider() {
      carouselTec = setInterval(function () {
        nextSlider();
      }, intervalTime);
    }

    function nextSlider() {
      var currentSlider = document.getElementById("slider-" + cont);
      var nextCont = (cont + 1) % totalSliders;
      var nextSlider = document.getElementById("slider-" + nextCont);
      var currentButton = document.getElementById("sButton" + (cont + 1));
      var nextButton = document.getElementById("sButton" + (nextCont + 1));

      fadeOut(currentSlider, function () {
        fadeIn(nextSlider);
      });
      currentButton.classList.remove("bg-purple-800");
      nextButton.classList.add("bg-purple-800");

      cont = nextCont;
    }

    function reinitLoop(time) {
      clearInterval(carouselTec);
      setTimeout(loopSlider, time);
    }

    function sliderButton(index) {
      var currentSlider = document.getElementById("slider-" + cont);
      var nextSlider = document.getElementById("slider-" + index);
      var currentButton = document.getElementById("sButton" + (cont + 1));
      var nextButton = document.getElementById("sButton" + (index + 1));

      fadeOut(currentSlider, function () {
        fadeIn(nextSlider);
      });
      currentButton.classList.remove("bg-purple-800");
      nextButton.classList.add("bg-purple-800");

      cont = index;
      reinitLoop(4000);
    }

    function fadeOut(element, callback) {
      var opacity = 1;
      var timer = setInterval(function () {
        if (opacity <= 0.1) {
          clearInterval(timer);
          element.style.display = "none";
          if (callback) callback();
        }
        element.style.opacity = opacity;
        opacity -= opacity * 0.1;
      }, 50);
    }

    function fadeIn(element) {
      var opacity = 0.1;
      element.style.display = "block";
      var timer = setInterval(function () {
        if (opacity >= 1) {
          clearInterval(timer);
        }
        element.style.opacity = opacity;
        opacity += opacity * 0.1;
      }, 50);
    }

    document.addEventListener("DOMContentLoaded", function () {
      for (var i = 1; i < totalSliders; i++) {
        document.getElementById("slider-" + i).style.display = "none";
      }
      document.getElementById("sButton1").classList.add("bg-purple-800");

      loopSlider();
    });

    // Para agregar botones de control adicionales:
    document.getElementById("sButton1").addEventListener("click", function () {
      sliderButton(0);
    });
    document.getElementById("sButton2").addEventListener("click", function () {
      sliderButton(1);
    });
    // Agrega más botones según sea necesario, ej:
    // document.getElementById("sButton3").addEventListener("click", function () { sliderButton(2); });
    // document.getElementById("sButton4").addEventListener("click", function () { sliderButton(3); });
  </script>
</body>
